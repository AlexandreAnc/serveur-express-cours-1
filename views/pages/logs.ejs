<!DOCTYPE html>
<html lang="fr">

<head>
<%- include('../layout/head', { title }) %>
</head>

<body>
    <%- include('../layout/header') %>

    <main class="container">
        <div class="log-page">
            <% if (isAuthenticated && user) { %>
                <h2 style="text-align: center; margin-bottom: 1rem;">Bienvenue <%= user.login %></h2>
            <% } %>
            <h2>Journal des requ√™tes</h2>
            <p class="log-subtitle">
                Voici les derni√®res actions d√©tect√©es par le serveur.
            </p>

            <div class="terminal">
                <div class="terminal-header">
                    <span class="dot dot-red"></span>
                    <span class="dot dot-yellow"></span>
                    <span class="dot dot-green"></span>
                    <span class="terminal-title">latest-log.txt</span>
                </div>
                <div class="terminal-body">
                    <% if (logs && logs.trim().length > 0) { %>
                        <% logs.split('\n').forEach(function(line, index) { 
                            if (!line.trim().length) return;
                        %>
                            <div class="terminal-line">
                                <span class="prompt">Œª</span>
                                <span class="line-content"><%= line %></span>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div class="terminal-line">
                            <span class="prompt">Œª</span>
                            <span class="line-content terminal-empty">
                                Aucun log pour le moment... le serveur s‚Äôennuie un peu üò¥
                            </span>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </main>

    <%- include('../layout/footer') %>
    
    <script>
        // D√©filement automatique vers le bas (logs les plus r√©cents) au chargement de la page
        window.addEventListener('DOMContentLoaded', function() {
            var terminalBody = document.querySelector('.terminal-body');
            if (terminalBody) {
                // D√©filer vers le bas imm√©diatement
                terminalBody.scrollTop = terminalBody.scrollHeight;
                
                // Attendre un peu pour s'assurer que tout est rendu, puis d√©filer √† nouveau
                setTimeout(function() {
                    terminalBody.scrollTop = terminalBody.scrollHeight;
                }, 100);
            }
        });
    </script>
</body>
</html>
